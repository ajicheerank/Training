import boto3
from datetime import datetime as dt
import requests
import json

dydb = boto3.resource("dynamodb")
cli_s3 = boto3.resource("s3")
bucket_s3 = cli_s3.Bucket("aji-cw-test")
mytbl = dydb.Table("aji_test_dsky")

now  = str(dt.now())

test = {"latitude":38,"longitude":-122,"timezone":"America/Los_Angeles","currently":{"time":1534172621,"summary":"Partly Cloudy","icon":"partly-cloudy-day","nearestStormDistance":44,"nearestStormBearing":126,"precipIntensity":0,"precipProbability":0,"temperature":60.74,"apparentTemperature":60.74,"dewPoint":52.24,"humidity":0.74,"pressure":1014.28,"windSpeed":5.95,"windGust":9.55,"windBearing":232,"cloudCover":0.26,"uvIndex":1,"visibility":10,"ozone":303.16},"minutely":{"summary":"Partly cloudy for the hour.","icon":"partly-cloudy-day","data":[{"time":1534172580,"precipIntensity":0,"precipProbability":0},{"time":1534172640,"precipIntensity":0,"precipProbability":0},{"time":1534172700,"precipIntensity":0,"precipProbability":0},{"time":1534172760,"precipIntensity":0,"precipProbability":0},{"time":1534172820,"precipIntensity":0,"precipProbability":0},{"time":1534172880,"precipIntensity":0,"precipProbability":0},{"time":1534172940,"precipIntensity":0,"precipProbability":0},{"time":1534173000,"precipIntensity":0,"precipProbability":0},{"time":1534173060,"precipIntensity":0,"precipProbability":0},{"time":1534173120,"precipIntensity":0,"precipProbability":0},{"time":1534173180,"precipIntensity":0,"precipProbability":0},{"time":1534173240,"precipIntensity":0,"precipProbability":0},{"time":1534173300,"precipIntensity":0,"precipProbability":0},{"time":1534173360,"precipIntensity":0,"precipProbability":0},{"time":1534173420,"precipIntensity":0,"precipProbability":0},{"time":1534173480,"precipIntensity":0,"precipProbability":0},{"time":1534173540,"precipIntensity":0,"precipProbability":0},{"time":1534173600,"precipIntensity":0,"precipProbability":0},{"time":1534173660,"precipIntensity":0,"precipProbability":0},{"time":1534173720,"precipIntensity":0,"precipProbability":0},{"time":1534173780,"precipIntensity":0,"precipProbability":0},{"time":1534173840,"precipIntensity":0,"precipProbability":0},{"time":1534173900,"precipIntensity":0,"precipProbability":0},{"time":1534173960,"precipIntensity":0,"precipProbability":0},{"time":1534174020,"precipIntensity":0,"precipProbability":0},{"time":1534174080,"precipIntensity":0,"precipProbability":0},{"time":1534174140,"precipIntensity":0,"precipProbability":0},{"time":1534174200,"precipIntensity":0,"precipProbability":0},{"time":1534174260,"precipIntensity":0,"precipProbability":0},{"time":1534174320,"precipIntensity":0,"precipProbability":0},{"time":1534174380,"precipIntensity":0,"precipProbability":0},{"time":1534174440,"precipIntensity":0,"precipProbability":0},{"time":1534174500,"precipIntensity":0,"precipProbability":0},{"time":1534174560,"precipIntensity":0,"precipProbability":0},{"time":1534174620,"precipIntensity":0,"precipProbability":0},{"time":1534174680,"precipIntensity":0,"precipProbability":0},{"time":1534174740,"precipIntensity":0,"precipProbability":0},{"time":1534174800,"precipIntensity":0,"precipProbability":0},{"time":1534174860,"precipIntensity":0,"precipProbability":0},{"time":1534174920,"precipIntensity":0,"precipProbability":0},{"time":1534174980,"precipIntensity":0,"precipProbability":0},{"time":1534175040,"precipIntensity":0,"precipProbability":0},{"time":1534175100,"precipIntensity":0,"precipProbability":0},{"time":1534175160,"precipIntensity":0,"precipProbability":0},{"time":1534175220,"precipIntensity":0,"precipProbability":0},{"time":1534175280,"precipIntensity":0,"precipProbability":0},{"time":1534175340,"precipIntensity":0,"precipProbability":0},{"time":1534175400,"precipIntensity":0,"precipProbability":0},{"time":1534175460,"precipIntensity":0,"precipProbability":0},{"time":1534175520,"precipIntensity":0,"precipProbability":0},{"time":1534175580,"precipIntensity":0,"precipProbability":0},{"time":1534175640,"precipIntensity":0,"precipProbability":0},{"time":1534175700,"precipIntensity":0,"precipProbability":0},{"time":1534175760,"precipIntensity":0,"precipProbability":0},{"time":1534175820,"precipIntensity":0,"precipProbability":0},{"time":1534175880,"precipIntensity":0,"precipProbability":0},{"time":1534175940,"precipIntensity":0,"precipProbability":0},{"time":1534176000,"precipIntensity":0,"precipProbability":0},{"time":1534176060,"precipIntensity":0,"precipProbability":0},{"time":1534176120,"precipIntensity":0,"precipProbability":0},{"time":1534176180,"precipIntensity":0,"precipProbability":0}]},"hourly":{"summary":"Partly cloudy starting tonight.","icon":"partly-cloudy-night","data":[{"time":1534172400,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.0006,"precipProbability":0.01,"precipType":"rain","temperature":60.35,"apparentTemperature":60.35,"dewPoint":52.23,"humidity":0.75,"pressure":1014.27,"windSpeed":5.86,"windGust":9.46,"windBearing":232,"cloudCover":0.26,"uvIndex":1,"visibility":10,"ozone":303.16},{"time":1534176000,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":66.6,"apparentTemperature":66.6,"dewPoint":51.62,"humidity":0.59,"pressure":1014.4,"windSpeed":7.31,"windGust":10.94,"windBearing":234,"cloudCover":0.23,"uvIndex":1,"visibility":10,"ozone":303.16},{"time":1534179600,"summary":"Clear","icon":"clear-day","precipIntensity":0.0018,"precipProbability":0.01,"precipType":"rain","temperature":73.44,"apparentTemperature":73.44,"dewPoint":51.71,"humidity":0.47,"pressure":1014.25,"windSpeed":8.25,"windGust":12.03,"windBearing":235,"cloudCover":0.19,"uvIndex":3,"visibility":10,"ozone":303.05},{"time":1534183200,"summary":"Clear","icon":"clear-day","precipIntensity":0.001,"precipProbability":0.01,"precipType":"rain","temperature":78.9,"apparentTemperature":78.9,"dewPoint":51.66,"humidity":0.39,"pressure":1014.23,"windSpeed":9.02,"windGust":12.55,"windBearing":235,"cloudCover":0.15,"uvIndex":5,"visibility":10,"ozone":303.05},{"time":1534186800,"summary":"Clear","icon":"clear-day","precipIntensity":0.0006,"precipProbability":0.01,"precipType":"rain","temperature":82.17,"apparentTemperature":82.17,"dewPoint":51.27,"humidity":0.34,"pressure":1014.05,"windSpeed":9.58,"windGust":12.64,"windBearing":238,"cloudCover":0.13,"uvIndex":8,"visibility":10,"ozone":302.84},{"time":1534190400,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":84.57,"apparentTemperature":84.57,"dewPoint":50.92,"humidity":0.31,"pressure":1013.47,"windSpeed":10.38,"windGust":13.15,"windBearing":240,"cloudCover":0.1,"uvIndex":9,"visibility":10,"ozone":302.62},{"time":1534194000,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":85.79,"apparentTemperature":85.79,"dewPoint":50.62,"humidity":0.3,"pressure":1012.91,"windSpeed":11.22,"windGust":14.04,"windBearing":241,"cloudCover":0.08,"uvIndex":9,"visibility":10,"ozone":302.29},{"time":1534197600,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":86.52,"apparentTemperature":86.52,"dewPoint":50.28,"humidity":0.29,"pressure":1012.43,"windSpeed":11.84,"windGust":14.96,"windBearing":241,"cloudCover":0.05,"uvIndex":7,"visibility":10,"ozone":301.75},{"time":1534201200,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":87.02,"apparentTemperature":87.02,"dewPoint":50.26,"humidity":0.28,"pressure":1011.93,"windSpeed":12.37,"windGust":15.97,"windBearing":240,"cloudCover":0.02,"uvIndex":4,"visibility":10,"ozone":301.31},{"time":1534204800,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":86.28,"apparentTemperature":86.28,"dewPoint":50.44,"humidity":0.29,"pressure":1011.58,"windSpeed":12.61,"windGust":16.99,"windBearing":238,"cloudCover":0.01,"uvIndex":2,"visibility":10,"ozone":300.76},{"time":1534208400,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":83.29,"apparentTemperature":83.29,"dewPoint":50.8,"humidity":0.33,"pressure":1011.31,"windSpeed":12.28,"windGust":17.8,"windBearing":235,"cloudCover":0,"uvIndex":1,"visibility":10,"ozone":300.43},{"time":1534212000,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":77.91,"apparentTemperature":77.91,"dewPoint":51.38,"humidity":0.4,"pressure":1011.18,"windSpeed":11.63,"windGust":18.55,"windBearing":231,"cloudCover":0.01,"uvIndex":0,"visibility":10,"ozone":300.1},{"time":1534215600,"summary":"Clear","icon":"clear-day","precipIntensity":0.0011,"precipProbability":0.01,"precipType":"rain","temperature":72.68,"apparentTemperature":72.68,"dewPoint":51.85,"humidity":0.48,"pressure":1011.21,"windSpeed":10.99,"windGust":18.82,"windBearing":228,"cloudCover":0.03,"uvIndex":0,"visibility":10,"ozone":299.78},{"time":1534219200,"summary":"Clear","icon":"clear-night","precipIntensity":0.0012,"precipProbability":0.01,"precipType":"rain","temperature":69.63,"apparentTemperature":69.63,"dewPoint":52.13,"humidity":0.54,"pressure":1011.45,"windSpeed":10.7,"windGust":18.95,"windBearing":227,"cloudCover":0.06,"uvIndex":0,"visibility":10,"ozone":299.67},{"time":1534222800,"summary":"Clear","icon":"clear-night","precipIntensity":0,"precipProbability":0,"temperature":67.71,"apparentTemperature":67.71,"dewPoint":53.71,"humidity":0.61,"pressure":1011.88,"windSpeed":9.64,"windGust":16.26,"windBearing":232,"cloudCover":0.13,"uvIndex":0,"visibility":10,"ozone":299.67},{"time":1534226400,"summary":"Clear","icon":"clear-night","precipIntensity":0,"precipProbability":0,"temperature":66.99,"apparentTemperature":66.99,"dewPoint":53.98,"humidity":0.63,"pressure":1012.09,"windSpeed":9.49,"windGust":15.59,"windBearing":233,"cloudCover":0.18,"uvIndex":0,"visibility":10,"ozone":299.45},{"time":1534230000,"summary":"Clear","icon":"clear-night","precipIntensity":0,"precipProbability":0,"temperature":66.4,"apparentTemperature":66.4,"dewPoint":54,"humidity":0.64,"pressure":1012.04,"windSpeed":9.38,"windGust":15.21,"windBearing":233,"cloudCover":0.22,"uvIndex":0,"visibility":10,"ozone":299.01},{"time":1534233600,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0.0004,"precipProbability":0.01,"precipType":"rain","temperature":65.32,"apparentTemperature":65.32,"dewPoint":53.89,"humidity":0.67,"pressure":1011.88,"windSpeed":9.24,"windGust":14.99,"windBearing":233,"cloudCover":0.27,"uvIndex":0,"visibility":10,"ozone":298.45},{"time":1534237200,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0.0005,"precipProbability":0.01,"precipType":"rain","temperature":63.76,"apparentTemperature":63.76,"dewPoint":53.81,"humidity":0.7,"pressure":1011.71,"windSpeed":9.04,"windGust":14.68,"windBearing":233,"cloudCover":0.3,"uvIndex":0,"visibility":10,"ozone":297.9},{"time":1534240800,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0.0005,"precipProbability":0.01,"precipType":"rain","temperature":62.26,"apparentTemperature":62.26,"dewPoint":53.8,"humidity":0.74,"pressure":1011.58,"windSpeed":8.71,"windGust":14.31,"windBearing":233,"cloudCover":0.34,"uvIndex":0,"visibility":10,"ozone":297.57},{"time":1534244400,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0.0005,"precipProbability":0.01,"precipType":"rain","temperature":61.2,"apparentTemperature":61.2,"dewPoint":53.75,"humidity":0.77,"pressure":1011.5,"windSpeed":8.27,"windGust":13.85,"windBearing":233,"cloudCover":0.37,"uvIndex":0,"visibility":10,"ozone":297.35},{"time":1534248000,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0.0006,"precipProbability":0.01,"precipType":"rain","temperature":60.96,"apparentTemperature":60.96,"dewPoint":53.74,"humidity":0.77,"pressure":1011.47,"windSpeed":7.94,"windGust":13.36,"windBearing":233,"cloudCover":0.39,"uvIndex":0,"visibility":10,"ozone":297.35},{"time":1534251600,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0.0005,"precipProbability":0.01,"precipType":"rain","temperature":60.85,"apparentTemperature":60.85,"dewPoint":53.72,"humidity":0.77,"pressure":1011.66,"windSpeed":7.8,"windGust":12.76,"windBearing":233,"cloudCover":0.41,"uvIndex":0,"visibility":10,"ozone":297.46},{"time":1534255200,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.0004,"precipProbability":0.01,"precipType":"rain","temperature":60.71,"apparentTemperature":60.71,"dewPoint":53.69,"humidity":0.78,"pressure":1011.9,"windSpeed":7.8,"windGust":12.16,"windBearing":233,"cloudCover":0.41,"uvIndex":0,"visibility":10,"ozone":298.01},{"time":1534258800,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.0004,"precipProbability":0.01,"precipType":"rain","temperature":61.58,"apparentTemperature":61.58,"dewPoint":53.67,"humidity":0.75,"pressure":1012.15,"windSpeed":7.85,"windGust":11.63,"windBearing":233,"cloudCover":0.4,"uvIndex":1,"visibility":10,"ozone":298.45},{"time":1534262400,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.0002,"precipProbability":0.01,"precipType":"rain","temperature":64.51,"apparentTemperature":64.51,"dewPoint":53.72,"humidity":0.68,"pressure":1012.32,"windSpeed":7.94,"windGust":11.1,"windBearing":234,"cloudCover":0.37,"uvIndex":1,"visibility":10,"ozone":298.78},{"time":1534266000,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":69.03,"apparentTemperature":69.03,"dewPoint":53.79,"humidity":0.58,"pressure":1012.46,"windSpeed":8.07,"windGust":10.64,"windBearing":237,"cloudCover":0.33,"uvIndex":3,"visibility":10,"ozone":299.12},{"time":1534269600,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":73.09,"apparentTemperature":73.09,"dewPoint":53.86,"humidity":0.51,"pressure":1012.51,"windSpeed":8.4,"windGust":10.55,"windBearing":238,"cloudCover":0.28,"uvIndex":5,"visibility":10,"ozone":299.34},{"time":1534273200,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":76.65,"apparentTemperature":76.65,"dewPoint":53.95,"humidity":0.45,"pressure":1012.46,"windSpeed":9.07,"windGust":11.07,"windBearing":240,"cloudCover":0.22,"uvIndex":7,"visibility":10,"ozone":299.23},{"time":1534276800,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":79.67,"apparentTemperature":79.67,"dewPoint":54.04,"humidity":0.41,"pressure":1012.32,"windSpeed":9.98,"windGust":11.98,"windBearing":240,"cloudCover":0.16,"uvIndex":9,"visibility":10,"ozone":299.01},{"time":1534280400,"summary":"Clear","icon":"clear-day","precipIntensity":0.0002,"precipProbability":0.01,"precipType":"rain","temperature":81.27,"apparentTemperature":81.27,"dewPoint":54.05,"humidity":0.39,"pressure":1012.07,"windSpeed":10.75,"windGust":13.03,"windBearing":241,"cloudCover":0.11,"uvIndex":9,"visibility":10,"ozone":298.67},{"time":1534284000,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":82.26,"apparentTemperature":82.26,"dewPoint":53.96,"humidity":0.38,"pressure":1011.61,"windSpeed":11.39,"windGust":14.28,"windBearing":241,"cloudCover":0.06,"uvIndex":7,"visibility":10,"ozone":298.45},{"time":1534287600,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":82.95,"apparentTemperature":82.95,"dewPoint":53.81,"humidity":0.37,"pressure":1011.05,"windSpeed":11.9,"windGust":15.62,"windBearing":241,"cloudCover":0.02,"uvIndex":4,"visibility":10,"ozone":298.12},{"time":1534291200,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":82.41,"apparentTemperature":82.41,"dewPoint":53.73,"humidity":0.37,"pressure":1010.7,"windSpeed":12.1,"windGust":16.61,"windBearing":240,"cloudCover":0,"uvIndex":2,"visibility":10,"ozone":298.01},{"time":1534294800,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":79.75,"apparentTemperature":79.75,"dewPoint":53.8,"humidity":0.41,"pressure":1010.6,"windSpeed":11.78,"windGust":16.96,"windBearing":238,"cloudCover":0,"uvIndex":1,"visibility":10,"ozone":298.12},{"time":1534298400,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":74.95,"apparentTemperature":74.95,"dewPoint":53.94,"humidity":0.48,"pressure":1010.67,"windSpeed":11.13,"windGust":16.96,"windBearing":237,"cloudCover":0,"uvIndex":0,"visibility":10,"ozone":298.34},{"time":1534302000,"summary":"Clear","icon":"clear-night","precipIntensity":0,"precipProbability":0,"temperature":70.5,"apparentTemperature":70.5,"dewPoint":54.12,"humidity":0.56,"pressure":1010.9,"windSpeed":10.58,"windGust":16.8,"windBearing":237,"cloudCover":0.02,"uvIndex":0,"visibility":10,"ozone":298.45},{"time":1534305600,"summary":"Clear","icon":"clear-night","precipIntensity":0,"precipProbability":0,"temperature":67.97,"apparentTemperature":67.97,"dewPoint":54.38,"humidity":0.62,"pressure":1011.34,"windSpeed":10.21,"windGust":16.54,"windBearing":235,"cloudCover":0.06,"uvIndex":0,"visibility":10,"ozone":298.56},{"time":1534309200,"summary":"Clear","icon":"clear-night","precipIntensity":0,"precipProbability":0,"temperature":66.67,"apparentTemperature":66.67,"dewPoint":54.71,"humidity":0.65,"pressure":1011.9,"windSpeed":9.95,"windGust":16.1,"windBearing":236,"cloudCover":0.11,"uvIndex":0,"visibility":10,"ozone":298.56},{"time":1534312800,"summary":"Clear","icon":"clear-night","precipIntensity":0,"precipProbability":0,"temperature":66.28,"apparentTemperature":66.28,"dewPoint":54.92,"humidity":0.67,"pressure":1012.32,"windSpeed":9.69,"windGust":15.62,"windBearing":234,"cloudCover":0.17,"uvIndex":0,"visibility":10,"ozone":298.45},{"time":1534316400,"summary":"Clear","icon":"clear-night","precipIntensity":0.0002,"precipProbability":0.01,"precipType":"rain","temperature":66.14,"apparentTemperature":66.14,"dewPoint":54.99,"humidity":0.67,"pressure":1012.4,"windSpeed":9.49,"windGust":15.28,"windBearing":234,"cloudCover":0.24,"uvIndex":0,"visibility":10,"ozone":297.68},{"time":1534320000,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0.0003,"precipProbability":0.01,"precipType":"rain","temperature":65.32,"apparentTemperature":65.32,"dewPoint":54.98,"humidity":0.69,"pressure":1012.32,"windSpeed":9.27,"windGust":14.96,"windBearing":233,"cloudCover":0.33,"uvIndex":0,"visibility":10,"ozone":296.68},{"time":1534323600,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0.0003,"precipProbability":0.01,"precipType":"rain","temperature":63.86,"apparentTemperature":63.86,"dewPoint":54.89,"humidity":0.73,"pressure":1012.23,"windSpeed":9.04,"windGust":14.56,"windBearing":233,"cloudCover":0.39,"uvIndex":0,"visibility":10,"ozone":295.9},{"time":1534327200,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0.0002,"precipProbability":0.01,"precipType":"rain","temperature":61.91,"apparentTemperature":61.91,"dewPoint":54.7,"humidity":0.77,"pressure":1012.18,"windSpeed":8.71,"windGust":13.94,"windBearing":233,"cloudCover":0.41,"uvIndex":0,"visibility":10,"ozone":295.35},{"time":1534330800,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":60.42,"apparentTemperature":60.42,"dewPoint":54.45,"humidity":0.81,"pressure":1012.12,"windSpeed":8.32,"windGust":13.27,"windBearing":233,"cloudCover":0.4,"uvIndex":0,"visibility":10,"ozone":294.9},{"time":1534334400,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":59.89,"apparentTemperature":59.89,"dewPoint":54.32,"humidity":0.82,"pressure":1012.21,"windSpeed":8.02,"windGust":12.61,"windBearing":233,"cloudCover":0.41,"uvIndex":0,"visibility":10,"ozone":294.68},{"time":1534338000,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":59.99,"apparentTemperature":59.99,"dewPoint":54.39,"humidity":0.82,"pressure":1012.51,"windSpeed":7.88,"windGust":12.07,"windBearing":233,"cloudCover":0.46,"uvIndex":0,"visibility":10,"ozone":294.68},{"time":1534341600,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.0003,"precipProbability":0.01,"precipType":"rain","temperature":60.16,"apparentTemperature":60.16,"dewPoint":54.61,"humidity":0.82,"pressure":1012.91,"windSpeed":7.8,"windGust":11.6,"windBearing":234,"cloudCover":0.52,"uvIndex":0,"visibility":10,"ozone":294.9},{"time":1534345200,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0.0004,"precipProbability":0.01,"precipType":"rain","temperature":61.58,"apparentTemperature":61.58,"dewPoint":54.73,"humidity":0.78,"pressure":1013.29,"windSpeed":7.85,"windGust":11.19,"windBearing":234,"cloudCover":0.56,"uvIndex":1,"visibility":10,"ozone":295.01}]},"daily":{"summary":"No precipitation throughout the week, with high temperatures rising to 98°F on Saturday.","icon":"clear-day","data":[{"time":1534143600,"summary":"Partly cloudy in the morning.","icon":"partly-cloudy-night","sunriseTime":1534166586,"sunsetTime":1534215919,"moonPhase":0.09,"precipIntensity":0.0004,"precipIntensityMax":0.0018,"precipIntensityMaxTime":1534179600,"precipProbability":0.06,"precipType":"rain","temperatureHigh":87.02,"temperatureHighTime":1534201200,"temperatureLow":60.71,"temperatureLowTime":1534255200,"apparentTemperatureHigh":87.02,"apparentTemperatureHighTime":1534201200,"apparentTemperatureLow":60.71,"apparentTemperatureLowTime":1534255200,"dewPoint":52.17,"humidity":0.56,"pressure":1012.78,"windSpeed":8.38,"windGust":18.95,"windGustTime":1534219200,"windBearing":236,"cloudCover":0.16,"uvIndex":9,"uvIndexTime":1534190400,"visibility":10,"ozone":301.99,"temperatureMin":57.79,"temperatureMinTime":1534165200,"temperatureMax":87.02,"temperatureMaxTime":1534201200,"apparentTemperatureMin":57.79,"apparentTemperatureMinTime":1534165200,"apparentTemperatureMax":87.02,"apparentTemperatureMaxTime":1534201200},{"time":1534230000,"summary":"Partly cloudy in the morning.","icon":"partly-cloudy-day","sunriseTime":1534253039,"sunsetTime":1534302244,"moonPhase":0.13,"precipIntensity":0.0003,"precipIntensityMax":0.0006,"precipIntensityMaxTime":1534248000,"precipProbability":0.08,"precipType":"rain","temperatureHigh":82.95,"temperatureHighTime":1534287600,"temperatureLow":59.89,"temperatureLowTime":1534334400,"apparentTemperatureHigh":82.95,"apparentTemperatureHighTime":1534287600,"apparentTemperatureLow":59.89,"apparentTemperatureLowTime":1534334400,"dewPoint":53.95,"humidity":0.59,"pressure":1011.71,"windSpeed":9.52,"windGust":16.96,"windGustTime":1534298400,"windBearing":236,"cloudCover":0.21,"uvIndex":9,"uvIndexTime":1534276800,"visibility":10,"ozone":298.37,"temperatureMin":60.71,"temperatureMinTime":1534255200,"temperatureMax":82.95,"temperatureMaxTime":1534287600,"apparentTemperatureMin":60.71,"apparentTemperatureMinTime":1534255200,"apparentTemperatureMax":82.95,"apparentTemperatureMaxTime":1534287600},{"time":1534316400,"summary":"Partly cloudy in the morning.","icon":"partly-cloudy-day","sunriseTime":1534339492,"sunsetTime":1534388569,"moonPhase":0.16,"precipIntensity":0.0002,"precipIntensityMax":0.0004,"precipIntensityMaxTime":1534345200,"precipProbability":0.05,"precipType":"rain","temperatureHigh":83.71,"temperatureHighTime":1534374000,"temperatureLow":60.28,"temperatureLowTime":1534428000,"apparentTemperatureHigh":83.71,"apparentTemperatureHighTime":1534374000,"apparentTemperatureLow":60.28,"apparentTemperatureLowTime":1534428000,"dewPoint":54.71,"humidity":0.6,"pressure":1012.98,"windSpeed":9.61,"windGust":17.15,"windGustTime":1534384800,"windBearing":236,"cloudCover":0.24,"uvIndex":9,"uvIndexTime":1534363200,"visibility":10,"ozone":294.66,"temperatureMin":59.89,"temperatureMinTime":1534334400,"temperatureMax":83.71,"temperatureMaxTime":1534374000,"apparentTemperatureMin":59.89,"apparentTemperatureMinTime":1534334400,"apparentTemperatureMax":83.71,"apparentTemperatureMaxTime":1534374000},{"time":1534402800,"summary":"Partly cloudy in the morning.","icon":"partly-cloudy-day","sunriseTime":1534425945,"sunsetTime":1534474893,"moonPhase":0.2,"precipIntensity":0.0002,"precipIntensityMax":0.0005,"precipIntensityMaxTime":1534431600,"precipProbability":0.01,"precipType":"rain","temperatureHigh":87.19,"temperatureHighTime":1534467600,"temperatureLow":61.23,"temperatureLowTime":1534510800,"apparentTemperatureHigh":87.19,"apparentTemperatureHighTime":1534467600,"apparentTemperatureLow":61.23,"apparentTemperatureLowTime":1534510800,"dewPoint":53.93,"humidity":0.55,"pressure":1015.43,"windSpeed":7.96,"windGust":15.72,"windGustTime":1534464000,"windBearing":235,"cloudCover":0.18,"uvIndex":10,"uvIndexTime":1534449600,"visibility":10,"ozone":297.47,"temperatureMin":60.28,"temperatureMinTime":1534428000,"temperatureMax":87.19,"temperatureMaxTime":1534467600,"apparentTemperatureMin":60.28,"apparentTemperatureMinTime":1534428000,"apparentTemperatureMax":87.19,"apparentTemperatureMaxTime":1534467600},{"time":1534489200,"summary":"Clear throughout the day.","icon":"clear-day","sunriseTime":1534512398,"sunsetTime":1534561216,"moonPhase":0.23,"precipIntensity":0,"precipIntensityMax":0,"precipProbability":0,"temperatureHigh":96.95,"temperatureHighTime":1534546800,"temperatureLow":61.51,"temperatureLowTime":1534597200,"apparentTemperatureHigh":96.95,"apparentTemperatureHighTime":1534546800,"apparentTemperatureLow":61.51,"apparentTemperatureLowTime":1534597200,"dewPoint":49.64,"humidity":0.43,"pressure":1015.45,"windSpeed":4.41,"windGust":12.79,"windGustTime":1534550400,"windBearing":238,"cloudCover":0,"uvIndex":10,"uvIndexTime":1534536000,"visibility":10,"ozone":290.33,"temperatureMin":61.23,"temperatureMinTime":1534510800,"temperatureMax":96.95,"temperatureMaxTime":1534546800,"apparentTemperatureMin":61.23,"apparentTemperatureMinTime":1534510800,"apparentTemperatureMax":96.95,"apparentTemperatureMaxTime":1534546800},{"time":1534575600,"summary":"Clear throughout the day.","icon":"clear-day","sunriseTime":1534598850,"sunsetTime":1534647538,"moonPhase":0.26,"precipIntensity":0,"precipIntensityMax":0,"precipProbability":0,"temperatureHigh":98.46,"temperatureHighTime":1534633200,"temperatureLow":61.41,"temperatureLowTime":1534683600,"apparentTemperatureHigh":98.46,"apparentTemperatureHighTime":1534633200,"apparentTemperatureLow":61.41,"apparentTemperatureLowTime":1534683600,"dewPoint":47.7,"humidity":0.37,"pressure":1012.8,"windSpeed":4.43,"windGust":14.96,"windGustTime":1534640400,"windBearing":235,"cloudCover":0,"uvIndex":10,"uvIndexTime":1534622400,"visibility":10,"ozone":287.58,"temperatureMin":61.51,"temperatureMinTime":1534597200,"temperatureMax":98.46,"temperatureMaxTime":1534633200,"apparentTemperatureMin":61.51,"apparentTemperatureMinTime":1534597200,"apparentTemperatureMax":98.46,"apparentTemperatureMaxTime":1534633200},{"time":1534662000,"summary":"Clear throughout the day.","icon":"clear-day","sunriseTime":1534685303,"sunsetTime":1534733858,"moonPhase":0.3,"precipIntensity":0.0001,"precipIntensityMax":0.0002,"precipIntensityMaxTime":1534708800,"precipProbability":0.01,"precipType":"rain","temperatureHigh":92.47,"temperatureHighTime":1534716000,"temperatureLow":58.97,"temperatureLowTime":1534773600,"apparentTemperatureHigh":92.47,"apparentTemperatureHighTime":1534716000,"apparentTemperatureLow":58.97,"apparentTemperatureLowTime":1534773600,"dewPoint":50.98,"humidity":0.45,"pressure":1009.86,"windSpeed":5.69,"windGust":20.42,"windGustTime":1534744800,"windBearing":236,"cloudCover":0,"uvIndex":10,"uvIndexTime":1534708800,"visibility":10,"ozone":281.16,"temperatureMin":61.41,"temperatureMinTime":1534683600,"temperatureMax":92.47,"temperatureMaxTime":1534716000,"apparentTemperatureMin":61.41,"apparentTemperatureMinTime":1534683600,"apparentTemperatureMax":92.47,"apparentTemperatureMaxTime":1534716000},{"time":1534748400,"summary":"Partly cloudy until afternoon.","icon":"partly-cloudy-day","sunriseTime":1534771755,"sunsetTime":1534820178,"moonPhase":0.33,"precipIntensity":0.0001,"precipIntensityMax":0.0003,"precipIntensityMaxTime":1534766400,"precipProbability":0.02,"precipType":"rain","temperatureHigh":84.15,"temperatureHighTime":1534806000,"temperatureLow":57.76,"temperatureLowTime":1534852800,"apparentTemperatureHigh":84.15,"apparentTemperatureHighTime":1534806000,"apparentTemperatureLow":57.76,"apparentTemperatureLowTime":1534852800,"dewPoint":53.77,"humidity":0.59,"pressure":1009.84,"windSpeed":7.33,"windGust":19.99,"windGustTime":1534820400,"windBearing":237,"cloudCover":0.15,"uvIndex":9,"uvIndexTime":1534795200,"visibility":10,"ozone":283.16,"temperatureMin":58.97,"temperatureMinTime":1534773600,"temperatureMax":84.15,"temperatureMaxTime":1534806000,"apparentTemperatureMin":58.97,"apparentTemperatureMinTime":1534773600,"apparentTemperatureMax":84.15,"apparentTemperatureMaxTime":1534806000}]},"flags":{"sources":["nearest-precip","nwspa","cmc","gfs","hrrr","icon","isd","madis","nam","sref","darksky"],"nearest-station":3.045,"units":"us"},"offset":-7}

print(test["currently"]["cloudCover"])
print(test["timezone"])

'''
key = "9dcb22304d253ce70535fd4574a90615c"
lattitude = "42.3601"
longitude = "-71.0589"

json_data = requests.get("https://api.darksky.net/forecast/"+ key + "/" + lattitude + "," + longitude,stream = True)
    
print(json_data.content)
mytbl.put_item(Item = {"json_result": str(json_data.text)})
   '''
#d3 =    json.dumps(test["currently"]["cloudCover"])
   
data = "Current Cloud Cover at {} = {} ".format (str(test["timezone"]), str(test["currently"]["cloudCover"]))   
print(data)
   
bucket_s3.put_object(Body = str.encode(data), Key = str(now) + ".json")